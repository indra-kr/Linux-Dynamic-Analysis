/*
* SystemCall/LibraryCall Tracer (syscalls.c)
*
*    Coded by 1ndr4 (indra.kr@gmail.com)
* 
* https://github.com/indra-kr/Linux-Dynamic-Analysis/blob/master/SLTracer/syscalls.c
*/

#include "config.h"

extern struct syscall_table syscalls[SYSCALL_NUMBER];

void make_syscall_table(void)
{	
	syscalls[0].number=0; syscalls[0].name="restart_syscall";
	syscalls[1].number=1; syscalls[1].name="exit";
	syscalls[2].number=2; syscalls[2].name="fork";
	syscalls[3].number=3; syscalls[3].name="read";
	syscalls[4].number=4; syscalls[4].name="write";
	syscalls[5].number=5; syscalls[5].name="open";
	syscalls[6].number=6; syscalls[6].name="close";
	syscalls[7].number=7; syscalls[7].name="waitpid";
	syscalls[8].number=8; syscalls[8].name="creat";
	syscalls[9].number=9; syscalls[9].name="link";
	syscalls[10].number=10; syscalls[10].name="unlink";
	syscalls[11].number=11; syscalls[11].name="execve";
	syscalls[12].number=12; syscalls[12].name="chdir";
	syscalls[13].number=13; syscalls[13].name="time";
	syscalls[14].number=14; syscalls[14].name="mknod";
	syscalls[15].number=15; syscalls[15].name="chmod";
	syscalls[16].number=16; syscalls[16].name="lchown";
	syscalls[17].number=17; syscalls[17].name="break";
	syscalls[18].number=18; syscalls[18].name="oldstat";
	syscalls[19].number=19; syscalls[19].name="lseek";
	syscalls[20].number=20; syscalls[20].name="getpid";
	syscalls[21].number=21; syscalls[21].name="mount";
	syscalls[22].number=22; syscalls[22].name="umount";
	syscalls[23].number=23; syscalls[23].name="setuid";
	syscalls[24].number=24; syscalls[24].name="getuid";
	syscalls[25].number=25; syscalls[25].name="stime";
	syscalls[26].number=26; syscalls[26].name="ptrace";
	syscalls[27].number=27; syscalls[27].name="alarm";
	syscalls[28].number=28; syscalls[28].name="oldfstat";
	syscalls[29].number=29; syscalls[29].name="pause";
	syscalls[30].number=30; syscalls[30].name="utime";
	syscalls[31].number=31; syscalls[31].name="stty";
	syscalls[32].number=32; syscalls[32].name="gtty";
	syscalls[33].number=33; syscalls[33].name="access";
	syscalls[34].number=34; syscalls[34].name="nice";
	syscalls[35].number=35; syscalls[35].name="ftime";
	syscalls[36].number=36; syscalls[36].name="sync";
	syscalls[37].number=37; syscalls[37].name="kill";
	syscalls[38].number=38; syscalls[38].name="rename";
	syscalls[39].number=39; syscalls[39].name="mkdir";
	syscalls[40].number=40; syscalls[40].name="rmdir";
	syscalls[41].number=41; syscalls[41].name="dup";
	syscalls[42].number=42; syscalls[42].name="pipe";
	syscalls[43].number=43; syscalls[43].name="times";
	syscalls[44].number=44; syscalls[44].name="prof";
	syscalls[45].number=45; syscalls[45].name="brk";
	syscalls[46].number=46; syscalls[46].name="setgid";
	syscalls[47].number=47; syscalls[47].name="getgid";
	syscalls[48].number=48; syscalls[48].name="signal";
	syscalls[49].number=49; syscalls[49].name="geteuid";
	syscalls[50].number=50; syscalls[50].name="getegid";
	syscalls[51].number=51; syscalls[51].name="acct";
	syscalls[52].number=52; syscalls[52].name="umount2";
	syscalls[53].number=53; syscalls[53].name="lock";
	syscalls[54].number=54; syscalls[54].name="ioctl";
	syscalls[55].number=55; syscalls[55].name="fcntl";
	syscalls[56].number=56; syscalls[56].name="mpx";
	syscalls[57].number=57; syscalls[57].name="setpgid";
	syscalls[58].number=58; syscalls[58].name="ulimit";
	syscalls[59].number=59; syscalls[59].name="oldolduname";
	syscalls[60].number=60; syscalls[60].name="umask";
	syscalls[61].number=61; syscalls[61].name="chroot";
	syscalls[62].number=62; syscalls[62].name="ustat";
	syscalls[63].number=63; syscalls[63].name="dup2";
	syscalls[64].number=64; syscalls[64].name="getppid";
	syscalls[65].number=65; syscalls[65].name="getpgrp";
	syscalls[66].number=66; syscalls[66].name="setsid";
	syscalls[67].number=67; syscalls[67].name="sigaction";
	syscalls[68].number=68; syscalls[68].name="sgetmask";
	syscalls[69].number=69; syscalls[69].name="ssetmask";
	syscalls[70].number=70; syscalls[70].name="setreuid";
	syscalls[71].number=71; syscalls[71].name="setregid";
	syscalls[72].number=72; syscalls[72].name="sigsuspend";
	syscalls[73].number=73; syscalls[73].name="sigpending";
	syscalls[74].number=74; syscalls[74].name="sethostname";
	syscalls[75].number=75; syscalls[75].name="setrlimit";
	syscalls[76].number=76; syscalls[76].name="getrlimit";
	syscalls[77].number=77; syscalls[77].name="getrusage";
	syscalls[78].number=78; syscalls[78].name="gettimeofday";
	syscalls[79].number=79; syscalls[79].name="settimeofday";
	syscalls[80].number=80; syscalls[80].name="getgroups";
	syscalls[81].number=81; syscalls[81].name="setgroups";
	syscalls[82].number=82; syscalls[82].name="select";
	syscalls[83].number=83; syscalls[83].name="symlink";
	syscalls[84].number=84; syscalls[84].name="oldlstat";
	syscalls[85].number=85; syscalls[85].name="readlink";
	syscalls[86].number=86; syscalls[86].name="uselib";
	syscalls[87].number=87; syscalls[87].name="swapon";
	syscalls[88].number=88; syscalls[88].name="reboot";
	syscalls[89].number=89; syscalls[89].name="readdir";
	syscalls[90].number=90; syscalls[90].name="mmap";
	syscalls[91].number=91; syscalls[91].name="munmap";
	syscalls[92].number=92; syscalls[92].name="truncate";
	syscalls[93].number=93; syscalls[93].name="ftruncate";
	syscalls[94].number=94; syscalls[94].name="fchmod";
	syscalls[95].number=95; syscalls[95].name="fchown";
	syscalls[96].number=96; syscalls[96].name="getpriority";
	syscalls[97].number=97; syscalls[97].name="setpriority";
	syscalls[98].number=98; syscalls[98].name="profil";
	syscalls[99].number=99; syscalls[99].name="statfs";
	syscalls[100].number=100; syscalls[100].name="fstatfs";
	syscalls[101].number=101; syscalls[101].name="ioperm";
	syscalls[102].number=102; syscalls[102].name="socketcall";
	syscalls[103].number=103; syscalls[103].name="syslog";
	syscalls[104].number=104; syscalls[104].name="setitimer";
	syscalls[105].number=105; syscalls[105].name="getitimer";
	syscalls[106].number=106; syscalls[106].name="stat";
	syscalls[107].number=107; syscalls[107].name="lstat";
	syscalls[108].number=108; syscalls[108].name="fstat";
	syscalls[109].number=109; syscalls[109].name="olduname";
	syscalls[110].number=110; syscalls[110].name="iopl";
	syscalls[111].number=111; syscalls[111].name="vhangup";
	syscalls[112].number=112; syscalls[112].name="idle";
	syscalls[113].number=113; syscalls[113].name="vm86old";
	syscalls[114].number=114; syscalls[114].name="wait4";
	syscalls[115].number=115; syscalls[115].name="swapoff";
	syscalls[116].number=116; syscalls[116].name="sysinfo";
	syscalls[117].number=117; syscalls[117].name="ipc";
	syscalls[118].number=118; syscalls[118].name="fsync";
	syscalls[119].number=119; syscalls[119].name="sigreturn";
	syscalls[120].number=120; syscalls[120].name="clone";
	syscalls[121].number=121; syscalls[121].name="setdomainname";
	syscalls[122].number=122; syscalls[122].name="uname";
	syscalls[123].number=123; syscalls[123].name="modify_ldt";
	syscalls[124].number=124; syscalls[124].name="adjtimex";
	syscalls[125].number=125; syscalls[125].name="mprotect";
	syscalls[126].number=126; syscalls[126].name="sigprocmask";
	syscalls[127].number=127; syscalls[127].name="create_module";
	syscalls[128].number=128; syscalls[128].name="init_module";
	syscalls[129].number=129; syscalls[129].name="delete_module";
	syscalls[130].number=130; syscalls[130].name="get_kernel_syms";
	syscalls[131].number=131; syscalls[131].name="quotactl";
	syscalls[132].number=132; syscalls[132].name="getpgid";
	syscalls[133].number=133; syscalls[133].name="fchdir";
	syscalls[134].number=134; syscalls[134].name="bdflush";
	syscalls[135].number=135; syscalls[135].name="sysfs";
	syscalls[136].number=136; syscalls[136].name="personality";
	syscalls[137].number=137; syscalls[137].name="afs_syscall";
	syscalls[138].number=138; syscalls[138].name="setfsuid";
	syscalls[139].number=139; syscalls[139].name="setfsgid";
	syscalls[140].number=140; syscalls[140].name="_llseek";
	syscalls[141].number=141; syscalls[141].name="getdents";
	syscalls[142].number=142; syscalls[142].name="_newselect";
	syscalls[143].number=143; syscalls[143].name="flock";
	syscalls[144].number=144; syscalls[144].name="msync";
	syscalls[145].number=145; syscalls[145].name="readv";
	syscalls[146].number=146; syscalls[146].name="writev";
	syscalls[147].number=147; syscalls[147].name="getsid";
	syscalls[148].number=148; syscalls[148].name="fdatasync";
	syscalls[149].number=149; syscalls[149].name="_sysctl";
	syscalls[150].number=150; syscalls[150].name="mlock";
	syscalls[151].number=151; syscalls[151].name="munlock";
	syscalls[152].number=152; syscalls[152].name="mlockall";
	syscalls[153].number=153; syscalls[153].name="munlockall";
	syscalls[154].number=154; syscalls[154].name="sched_setparam";
	syscalls[155].number=155; syscalls[155].name="sched_getparam";
	syscalls[156].number=156; syscalls[156].name="sched_setscheduler";
	syscalls[157].number=157; syscalls[157].name="sched_getscheduler";
	syscalls[158].number=158; syscalls[158].name="sched_yield";
	syscalls[159].number=159; syscalls[159].name="sched_get_priority_max";
	syscalls[160].number=160; syscalls[160].name="sched_get_priority_min";
	syscalls[161].number=161; syscalls[161].name="sched_rr_get_interval";
	syscalls[162].number=162; syscalls[162].name="nanosleep";
	syscalls[163].number=163; syscalls[163].name="mremap";
	syscalls[164].number=164; syscalls[164].name="setresuid";
	syscalls[165].number=165; syscalls[165].name="getresuid";
	syscalls[166].number=166; syscalls[166].name="vm86";
	syscalls[167].number=167; syscalls[167].name="query_module";
	syscalls[168].number=168; syscalls[168].name="poll";
	syscalls[169].number=169; syscalls[169].name="nfsservctl";
	syscalls[170].number=170; syscalls[170].name="setresgid";
	syscalls[171].number=171; syscalls[171].name="getresgid";
	syscalls[172].number=172; syscalls[172].name="prctl";
	syscalls[173].number=173; syscalls[173].name="rt_sigreturn";
	syscalls[174].number=174; syscalls[174].name="rt_sigaction";
	syscalls[175].number=175; syscalls[175].name="rt_sigprocmask";
	syscalls[176].number=176; syscalls[176].name="rt_sigpending";
	syscalls[177].number=177; syscalls[177].name="rt_sigtimedwait";
	syscalls[178].number=178; syscalls[178].name="rt_sigqueueinfo";
	syscalls[179].number=179; syscalls[179].name="rt_sigsuspend";
	syscalls[180].number=180; syscalls[180].name="pread64";
	syscalls[181].number=181; syscalls[181].name="pwrite64";
	syscalls[182].number=182; syscalls[182].name="chown";
	syscalls[183].number=183; syscalls[183].name="getcwd";
	syscalls[184].number=184; syscalls[184].name="capget";
	syscalls[185].number=185; syscalls[185].name="capset";
	syscalls[186].number=186; syscalls[186].name="sigaltstack";
	syscalls[187].number=187; syscalls[187].name="sendfile";
	syscalls[188].number=188; syscalls[188].name="getpmsg";
	syscalls[189].number=189; syscalls[189].name="putpmsg";
	syscalls[190].number=190; syscalls[190].name="vfork";
	syscalls[191].number=191; syscalls[191].name="ugetrlimit";
	syscalls[192].number=192; syscalls[192].name="mmap2";
	syscalls[193].number=193; syscalls[193].name="truncate64";
	syscalls[194].number=194; syscalls[194].name="ftruncate64";
	syscalls[195].number=195; syscalls[195].name="stat64";
	syscalls[196].number=196; syscalls[196].name="lstat64";
	syscalls[197].number=197; syscalls[197].name="fstat64";
	syscalls[198].number=198; syscalls[198].name="lchown32";
	syscalls[199].number=199; syscalls[199].name="getuid32";
	syscalls[200].number=200; syscalls[200].name="getgid32";
	syscalls[201].number=201; syscalls[201].name="geteuid32";
	syscalls[202].number=202; syscalls[202].name="getegid32";
	syscalls[203].number=203; syscalls[203].name="setreuid32";
	syscalls[204].number=204; syscalls[204].name="setregid32";
	syscalls[205].number=205; syscalls[205].name="getgroups32";
	syscalls[206].number=206; syscalls[206].name="setgroups32";
	syscalls[207].number=207; syscalls[207].name="fchown32";
	syscalls[208].number=208; syscalls[208].name="setresuid32";
	syscalls[209].number=209; syscalls[209].name="getresuid32";
	syscalls[210].number=210; syscalls[210].name="setresgid32";
	syscalls[211].number=211; syscalls[211].name="getresgid32";
	syscalls[212].number=212; syscalls[212].name="chown32";
	syscalls[213].number=213; syscalls[213].name="setuid32";
	syscalls[214].number=214; syscalls[214].name="setgid32";
	syscalls[215].number=215; syscalls[215].name="setfsuid32";
	syscalls[216].number=216; syscalls[216].name="setfsgid32";
	syscalls[217].number=217; syscalls[217].name="pivot_root";
	syscalls[218].number=218; syscalls[218].name="mincore";
	syscalls[219].number=219; syscalls[219].name="madvise";
	syscalls[220].number=219; syscalls[220].name="madvise1";
	syscalls[221].number=220; syscalls[221].name="getdents64";
	syscalls[222].number=221; syscalls[222].name="fcntl64";
	syscalls[223].number=224; syscalls[223].name="gettid";
	syscalls[224].number=225; syscalls[224].name="readahead";
	syscalls[225].number=226; syscalls[225].name="setxattr";
	syscalls[226].number=227; syscalls[226].name="lsetxattr";
	syscalls[227].number=228; syscalls[227].name="fsetxattr";
	syscalls[228].number=229; syscalls[228].name="getxattr";
	syscalls[229].number=230; syscalls[229].name="lgetxattr";
	syscalls[230].number=231; syscalls[230].name="fgetxattr";
	syscalls[231].number=232; syscalls[231].name="listxattr";
	syscalls[232].number=233; syscalls[232].name="llistxattr";
	syscalls[233].number=234; syscalls[233].name="flistxattr";
	syscalls[234].number=235; syscalls[234].name="removexattr";
	syscalls[235].number=236; syscalls[235].name="lremovexattr";
	syscalls[236].number=237; syscalls[236].name="fremovexattr";
	syscalls[237].number=238; syscalls[237].name="tkill";
	syscalls[238].number=239; syscalls[238].name="sendfile64";
	syscalls[239].number=240; syscalls[239].name="futex";
	syscalls[240].number=241; syscalls[240].name="sched_setaffinity";
	syscalls[241].number=242; syscalls[241].name="sched_getaffinity";
	syscalls[242].number=243; syscalls[242].name="set_thread_area";
	syscalls[243].number=244; syscalls[243].name="get_thread_area";
	syscalls[244].number=245; syscalls[244].name="io_setup";
	syscalls[245].number=246; syscalls[245].name="io_destroy";
	syscalls[246].number=247; syscalls[246].name="io_getevents";
	syscalls[247].number=248; syscalls[247].name="io_submit";
	syscalls[248].number=249; syscalls[248].name="io_cancel";
	syscalls[249].number=250; syscalls[249].name="fadvise64";
	syscalls[250].number=252; syscalls[250].name="exit_group";
	syscalls[251].number=253; syscalls[251].name="lookup_dcookie";
	syscalls[252].number=254; syscalls[252].name="epoll_create";
	syscalls[253].number=255; syscalls[253].name="epoll_ctl";
	syscalls[254].number=256; syscalls[254].name="epoll_wait";
	syscalls[255].number=257; syscalls[255].name="remap_file_pages";
	syscalls[256].number=258; syscalls[256].name="set_tid_address";
	syscalls[257].number=259; syscalls[257].name="timer_create";
	syscalls[258].number=260; syscalls[258].name="timer_settime";
	syscalls[259].number=261; syscalls[259].name="timer_gettime";
	syscalls[260].number=262; syscalls[260].name="timer_getoverrun";
	syscalls[261].number=263; syscalls[261].name="timer_delete";
	syscalls[262].number=264; syscalls[262].name="clock_settime";
	syscalls[263].number=265; syscalls[263].name="clock_gettime";
	syscalls[264].number=266; syscalls[264].name="clock_getres";
	syscalls[265].number=267; syscalls[265].name="clock_nanosleep";
	syscalls[266].number=268; syscalls[266].name="statfs64";
	syscalls[267].number=269; syscalls[267].name="fstatfs64";
	syscalls[268].number=270; syscalls[268].name="tgkill";
	syscalls[269].number=271; syscalls[269].name="utimes";
	syscalls[270].number=272; syscalls[270].name="fadvise64_64";
	syscalls[271].number=273; syscalls[271].name="vserver";
	syscalls[272].number=274; syscalls[272].name="mbind";
	syscalls[273].number=275; syscalls[273].name="get_mempolicy";
	syscalls[274].number=276; syscalls[274].name="set_mempolicy";
	syscalls[275].number=277; syscalls[275].name="mq_open";
	syscalls[276].number=278; syscalls[276].name="mq_unlink";
	syscalls[277].number=279; syscalls[277].name="mq_timedsend";
	syscalls[278].number=280; syscalls[278].name="mq_timedreceive";
	syscalls[279].number=281; syscalls[279].name="mq_notify";
	syscalls[280].number=282; syscalls[280].name="mq_getsetattr";
	syscalls[281].number=283; syscalls[281].name="kexec_load";
	syscalls[282].number=284; syscalls[282].name="waitid";
	syscalls[283].number=286; syscalls[283].name="add_key";
	syscalls[284].number=287; syscalls[284].name="request_key";
	syscalls[285].number=288; syscalls[285].name="keyctl";
	syscalls[286].number=289; syscalls[286].name="ioprio_set";
	syscalls[287].number=290; syscalls[287].name="ioprio_get";
	syscalls[288].number=291; syscalls[288].name="inotify_init";
	syscalls[289].number=292; syscalls[289].name="inotify_add_watch";
	syscalls[290].number=293; syscalls[290].name="inotify_rm_watch";
	syscalls[291].number=294; syscalls[291].name="migrate_pages";
	syscalls[292].number=295; syscalls[292].name="openat";
	syscalls[293].number=296; syscalls[293].name="mkdirat";
	syscalls[294].number=297; syscalls[294].name="mknodat";
	syscalls[295].number=298; syscalls[295].name="fchownat";
	syscalls[296].number=299; syscalls[296].name="futimesat";
	syscalls[297].number=300; syscalls[297].name="fstatat64";
	syscalls[298].number=301; syscalls[298].name="unlinkat";
	syscalls[299].number=302; syscalls[299].name="renameat";
	syscalls[300].number=303; syscalls[300].name="linkat";
	syscalls[301].number=304; syscalls[301].name="symlinkat";
	syscalls[302].number=305; syscalls[302].name="readlinkat";
	syscalls[303].number=306; syscalls[303].name="fchmodat";
	syscalls[304].number=307; syscalls[304].name="faccessat";
	syscalls[305].number=308; syscalls[305].name="pselect6";
	syscalls[306].number=309; syscalls[306].name="ppoll";
	syscalls[307].number=310; syscalls[307].name="unshare";
	syscalls[308].number=311; syscalls[308].name="set_robust_list";
	syscalls[309].number=312; syscalls[309].name="get_robust_list";
	syscalls[310].number=313; syscalls[310].name="splice";
	syscalls[311].number=314; syscalls[311].name="sync_file_range";
	syscalls[312].number=315; syscalls[312].name="tee";
	syscalls[313].number=316; syscalls[313].name="vmsplice";
	syscalls[314].number=317; syscalls[314].name="move_pages";
	syscalls[315].number=318; syscalls[315].name="getcpu";
	syscalls[316].number=323; syscalls[316].name="eventfd";
	syscalls[317].number=324; syscalls[317].name="fallocate";
	syscalls[318].number=337; syscalls[318].name="recvmmsg";
	return;
}

char *get_syscall_name(int sc_number)
{
	int i;

	for(i = 0; i < SYSCALL_NUMBER; i++) {
		if(sc_number == syscalls[i].number) {
			return syscalls[i].name;
		}
	}
	return NULL;
}

int get_syscall_number(const char *sc_name)
{
	int i, len;

	if(sc_name == NULL) return -1;
	len = strlen(sc_name);
	for(i = 0; i < SYSCALL_NUMBER; i++) {
		if(memcmp(sc_name, syscalls[i].name, len) == 0)
			return syscalls[i].number;
	}
	return -1;
}

